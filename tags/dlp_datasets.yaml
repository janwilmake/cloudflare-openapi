openapi: 3.0.3
info:
  description: >-
    Welcome to Cloudflare's API documentation site. We are experimenting with an
    updated version of our API documentation - check out
    [developers.cloudflare.com/api-next/](https://developers.cloudflare.com/api-next/)
    to test out the new experience.


    To get started using Cloudflare's products and services via the API, refer
    to [how to interact with
    Cloudflare](https://developers.cloudflare.com/fundamentals/basic-tasks/interact-with-cloudflare/),
    which covers using tools like
    [Terraform](https://developers.cloudflare.com/terraform/#cloudflare-terraform)
    and the [official
    SDKs](https://developers.cloudflare.com/fundamentals/api/reference/sdks/) to
    maintain your Cloudflare resources.


    Using the Cloudflare API requires authentication so that Cloudflare knows
    who is making requests and what permissions you have. Create an API token to
    grant access to the API to perform actions. You can also authenticate with
    [API
    keys](https://developers.cloudflare.com/fundamentals/api/get-started/keys/),
    but these keys have [several
    limitations](https://developers.cloudflare.com/fundamentals/api/get-started/keys/#limitations)
    that make them less secure than API tokens. Whenever possible, use API
    tokens to interact with the Cloudflare API.


    To create an API token, from the Cloudflare dashboard, go to My Profile >
    API Tokens and select Create Token. For more information on how to create
    and troubleshoot API tokens, refer to

    our [API fundamentals](https://developers.cloudflare.com/fundamentals/api/).


    For information regarding rate limits, refer to our [API Rate
    Limits](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/platform/limits/#api-rate-limits).


    Totally new to Cloudflare? [Start
    here](https://developers.cloudflare.com/fundamentals/get-started/).
  license:
    name: BSD-3-Clause
    url: https://opensource.org/licenses/BSD-3-Clause
  title: Cloudflare API
  version: 4.0.0
servers:
  - description: Client API
    url: https://api.cloudflare.com/client/v4
paths:
  /accounts/{account_id}/dlp/datasets:
    get:
      operationId: dlp-datasets-read-all
      parameters:
        - in: path
          name: account_id
          required: true
          schema:
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/dlp_api-response-single'
                  - properties:
                      result:
                        $ref: '#/components/schemas/dlp_DatasetArray'
                    type: object
          description: Datasets read successfully.
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/dlp_api-response-common-failure'
          description: Datasets read failed.
      security:
        - api_email: []
          api_key: []
          api_token: []
      summary: Fetch all datasets
      tags:
        - DLP Datasets
      x-api-token-group:
        - Zero Trust Read
        - Zero Trust Write
    post:
      operationId: dlp-datasets-create
      parameters:
        - in: path
          name: account_id
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/dlp_NewDataset'
        description: Dataset description.
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/dlp_api-response-single'
                  - properties:
                      result:
                        $ref: '#/components/schemas/dlp_DatasetCreation'
                    type: object
          description: Dataset created successfully.
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/dlp_api-response-common-failure'
          description: Dataset creation failed.
      security:
        - api_email: []
          api_key: []
          api_token: []
      summary: Create a new dataset
      tags:
        - DLP Datasets
      x-api-token-group:
        - Zero Trust Write
  /accounts/{account_id}/dlp/datasets/{dataset_id}:
    get:
      operationId: dlp-datasets-read
      parameters:
        - in: path
          name: account_id
          required: true
          schema:
            type: string
        - in: path
          name: dataset_id
          required: true
          schema:
            format: uuid
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/dlp_api-response-single'
                  - properties:
                      result:
                        $ref: '#/components/schemas/dlp_Dataset'
                    type: object
          description: Dataset read successfully.
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/dlp_api-response-common-failure'
          description: Dataset read failed.
      security:
        - api_email: []
          api_key: []
          api_token: []
      summary: Fetch a specific dataset
      tags:
        - DLP Datasets
      x-api-token-group:
        - Zero Trust Read
        - Zero Trust Write
    put:
      operationId: dlp-datasets-update
      parameters:
        - in: path
          name: account_id
          required: true
          schema:
            type: string
        - in: path
          name: dataset_id
          required: true
          schema:
            format: uuid
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/dlp_DatasetUpdate'
        description: Dataset description.
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/dlp_api-response-single'
                  - properties:
                      result:
                        $ref: '#/components/schemas/dlp_Dataset'
                    type: object
          description: Dataset updated successfully.
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/dlp_api-response-common-failure'
          description: Dataset update failed.
      security:
        - api_email: []
          api_key: []
          api_token: []
      summary: Update details about a dataset
      tags:
        - DLP Datasets
      x-api-token-group:
        - Zero Trust Write
    delete:
      description: This deletes all versions of the dataset.
      operationId: dlp-datasets-delete
      parameters:
        - in: path
          name: account_id
          required: true
          schema:
            type: string
        - in: path
          name: dataset_id
          required: true
          schema:
            format: uuid
            type: string
      responses:
        '200':
          description: Dataset deleted successfully.
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/dlp_api-response-common-failure'
          description: Dataset delete failed.
      security:
        - api_email: []
          api_key: []
          api_token: []
      summary: Delete a dataset
      tags:
        - DLP Datasets
      x-api-token-group:
        - Zero Trust Write
  /accounts/{account_id}/dlp/datasets/{dataset_id}/upload:
    post:
      operationId: dlp-datasets-create-version
      parameters:
        - in: path
          name: account_id
          required: true
          schema:
            type: string
        - in: path
          name: dataset_id
          required: true
          schema:
            format: uuid
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/dlp_api-response-single'
                  - properties:
                      result:
                        $ref: '#/components/schemas/dlp_DatasetNewVersion'
                    type: object
          description: Dataset version created successfully.
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/dlp_api-response-common-failure'
          description: Dataset version creation failed.
      security:
        - api_email: []
          api_key: []
          api_token: []
      summary: Prepare to upload a new version of a dataset
      tags:
        - DLP Datasets
      x-api-token-group:
        - Zero Trust Write
  /accounts/{account_id}/dlp/datasets/{dataset_id}/upload/{version}:
    post:
      description: >-
        This is used for single-column EDMv1 and Custom Word Lists. The EDM
        format

        can only be created in the Cloudflare dashboard. For other clients, this

        operation can only be used for non-secret Custom Word Lists. The body
        must

        be a UTF-8 encoded, newline (NL or CRNL) separated list of words to be
        matched.
      operationId: dlp-datasets-upload-version
      parameters:
        - in: path
          name: account_id
          required: true
          schema:
            type: string
        - in: path
          name: dataset_id
          required: true
          schema:
            format: uuid
            type: string
        - in: path
          name: version
          required: true
          schema:
            format: int64
            type: integer
      requestBody:
        content:
          application/octet-stream:
            schema:
              format: binary
              type: string
        description: >-
          Dataset. For custom wordlists this contains UTF-8 patterns separated
          by newline characters.
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/dlp_api-response-single'
                  - properties:
                      result:
                        $ref: '#/components/schemas/dlp_Dataset'
                    type: object
          description: Dataset version uploaded successfully.
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/dlp_api-response-common-failure'
          description: Dataset version upload failed.
      security:
        - api_email: []
          api_key: []
          api_token: []
      summary: Upload a new version of a dataset
      tags:
        - DLP Datasets
      x-api-token-group:
        - Zero Trust Write
  /accounts/{account_id}/dlp/datasets/{dataset_id}/versions/{version}:
    post:
      description: >-
        This is used for multi-column EDMv2 datasets. The EDMv2 format can only
        be

        created in the Cloudflare dashboard. The columns in the response appear
        in

        the same order as in the request.
      operationId: dlp-datasets-define-columns
      parameters:
        - in: path
          name: account_id
          required: true
          schema:
            type: string
        - in: path
          name: dataset_id
          required: true
          schema:
            format: uuid
            type: string
        - in: path
          name: version
          required: true
          schema:
            format: int64
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              items:
                $ref: '#/components/schemas/dlp_NewDatasetColumn'
              type: array
        description: array of new columns to create for this dataset version.
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/dlp_api-response-single'
                  - properties:
                      result:
                        $ref: '#/components/schemas/dlp_DatasetColumnArray'
                    type: object
          description: Dataset columns created successfully.
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/dlp_api-response-common-failure'
          description: Failed to create dataset columns.
      security:
        - api_email: []
          api_key: []
          api_token: []
      summary: Sets the column information for a multi-column upload
      tags:
        - DLP Datasets
      x-api-token-group:
        - Zero Trust Write
  /accounts/{account_id}/dlp/datasets/{dataset_id}/versions/{version}/entries/{entry_id}:
    post:
      description: >-
        This is used for multi-column EDMv2 datasets. The EDMv2 format can only
        be

        created in the Cloudflare dashboard.
      operationId: dlp-datasets-upload-dataset-column
      parameters:
        - in: path
          name: account_id
          required: true
          schema:
            type: string
        - in: path
          name: dataset_id
          required: true
          schema:
            format: uuid
            type: string
        - in: path
          name: version
          required: true
          schema:
            format: int64
            type: integer
        - in: path
          name: entry_id
          required: true
          schema:
            format: uuid
            type: string
      requestBody:
        content:
          application/octet-stream:
            schema:
              format: binary
              type: string
        description: Dataset content.
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/dlp_api-response-single'
                  - properties:
                      result:
                        $ref: '#/components/schemas/dlp_DatasetColumn'
                    type: object
          description: Dataset column uploaded successfully.
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/dlp_api-response-common-failure'
          description: Failed to upload dataset column.
      security:
        - api_email: []
          api_key: []
          api_token: []
      summary: Upload a new version of a multi-column dataset
      tags:
        - DLP Datasets
      x-api-token-group:
        - Zero Trust Write
components:
  schemas:
    dlp_Dataset:
      properties:
        case_sensitive:
          type: boolean
        columns:
          items:
            $ref: '#/components/schemas/dlp_DatasetColumn'
          type: array
        created_at:
          format: date-time
          type: string
        description:
          description: The description of the dataset.
          nullable: true
          type: string
        encoding_version:
          format: int32
          minimum: 0
          type: integer
        id:
          format: uuid
          type: string
        name:
          type: string
        num_cells:
          format: int64
          type: integer
        secret:
          type: boolean
        status:
          $ref: '#/components/schemas/dlp_DatasetUploadStatus'
        updated_at:
          description: |-
            When the dataset was last updated.

            This includes name or description changes as well as uploads.
          format: date-time
          type: string
        uploads:
          items:
            $ref: '#/components/schemas/dlp_DatasetUpload'
          type: array
      required:
        - name
        - id
        - status
        - num_cells
        - created_at
        - updated_at
        - uploads
        - secret
        - encoding_version
        - columns
      type: object
    dlp_DatasetArray:
      items:
        $ref: '#/components/schemas/dlp_Dataset'
      type: array
    dlp_DatasetColumn:
      properties:
        entry_id:
          format: uuid
          type: string
        header_name:
          type: string
        num_cells:
          format: int64
          type: integer
        upload_status:
          $ref: '#/components/schemas/dlp_DatasetUploadStatus'
      required:
        - entry_id
        - upload_status
        - header_name
        - num_cells
      type: object
    dlp_DatasetColumnArray:
      items:
        $ref: '#/components/schemas/dlp_DatasetColumn'
      type: array
    dlp_DatasetCreation:
      properties:
        dataset:
          $ref: '#/components/schemas/dlp_Dataset'
        encoding_version:
          description: Encoding version to use for dataset.
          format: int32
          minimum: 0
          type: integer
        max_cells:
          format: int64
          minimum: 0
          type: integer
        secret:
          description: >-
            The secret to use for Exact Data Match datasets. This is not present
            in

            Custom Wordlists.
          format: password
          type: string
        version:
          description: The version to use when uploading the dataset.
          format: int64
          type: integer
      required:
        - version
        - max_cells
        - dataset
        - encoding_version
      type: object
    dlp_DatasetNewVersion:
      properties:
        case_sensitive:
          type: boolean
        columns:
          items:
            $ref: '#/components/schemas/dlp_DatasetColumn'
          type: array
        encoding_version:
          format: int32
          minimum: 0
          type: integer
        max_cells:
          format: int64
          minimum: 0
          type: integer
        secret:
          format: password
          type: string
        version:
          format: int64
          type: integer
      required:
        - version
        - max_cells
        - encoding_version
      type: object
    dlp_DatasetUpdate:
      properties:
        case_sensitive:
          description: >-
            Determines if the words should be matched in a case-sensitive
            manner.


            Only required for custom word lists.
          type: boolean
        description:
          description: The description of the dataset.
          nullable: true
          type: string
        name:
          description: The name of the dataset, must be unique.
          nullable: true
          type: string
      type: object
    dlp_NewDataset:
      properties:
        case_sensitive:
          description: |-
            Only applies to custom word lists.
            Determines if the words should be matched in a case-sensitive manner
            Cannot be set to false if `secret` is true or undefined
          type: boolean
        description:
          description: The description of the dataset.
          nullable: true
          type: string
        encoding_version:
          description: >-
            Dataset encoding version


            Non-secret custom word lists with no header are always version 1.

            Secret EDM lists with no header are version 1.

            Multicolumn CSV with headers are version 2.

            Omitting this field provides the default value 0, which is
            interpreted

            the same as 1.
          format: int32
          minimum: 0
          type: integer
        name:
          type: string
        secret:
          description: >-
            Generate a secret dataset.


            If true, the response will include a secret to use with the EDM
            encoder.

            If false, the response has no secret and the dataset is uploaded in
            plaintext.
          type: boolean
      required:
        - name
      type: object
    dlp_NewDatasetColumn:
      allOf:
        - oneOf:
            - properties:
                entry_id:
                  format: uuid
                  type: string
              required:
                - entry_id
              title: Existing Column
              type: object
            - properties:
                entry_name:
                  type: string
              required:
                - entry_name
              title: New Column
              type: object
        - properties:
            header_name:
              type: string
            num_cells:
              format: int64
              type: integer
          required:
            - header_name
            - num_cells
          type: object
    dlp_api-response-common-failure:
      properties:
        errors:
          allOf:
            - $ref: '#/components/schemas/dlp_messages'
          example:
            - code: 7003
              message: No route for the URI
          minLength: 1
        messages:
          allOf:
            - $ref: '#/components/schemas/dlp_messages'
          example: []
        result:
          enum:
            - null
          nullable: true
          type: object
        success:
          description: Whether the API call was successful.
          enum:
            - false
          example: false
          type: boolean
      required:
        - success
        - errors
        - messages
        - result
      type: object
    dlp_api-response-single:
      allOf:
        - $ref: '#/components/schemas/dlp_api-response-common'
      type: object
