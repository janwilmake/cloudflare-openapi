openapi: 3.0.3
info:
  description: >-
    Welcome to Cloudflare's API documentation site. We are experimenting with an
    updated version of our API documentation - check out
    [developers.cloudflare.com/api-next/](https://developers.cloudflare.com/api-next/)
    to test out the new experience.


    To get started using Cloudflare's products and services via the API, refer
    to [how to interact with
    Cloudflare](https://developers.cloudflare.com/fundamentals/basic-tasks/interact-with-cloudflare/),
    which covers using tools like
    [Terraform](https://developers.cloudflare.com/terraform/#cloudflare-terraform)
    and the [official
    SDKs](https://developers.cloudflare.com/fundamentals/api/reference/sdks/) to
    maintain your Cloudflare resources.


    Using the Cloudflare API requires authentication so that Cloudflare knows
    who is making requests and what permissions you have. Create an API token to
    grant access to the API to perform actions. You can also authenticate with
    [API
    keys](https://developers.cloudflare.com/fundamentals/api/get-started/keys/),
    but these keys have [several
    limitations](https://developers.cloudflare.com/fundamentals/api/get-started/keys/#limitations)
    that make them less secure than API tokens. Whenever possible, use API
    tokens to interact with the Cloudflare API.


    To create an API token, from the Cloudflare dashboard, go to My Profile >
    API Tokens and select Create Token. For more information on how to create
    and troubleshoot API tokens, refer to

    our [API fundamentals](https://developers.cloudflare.com/fundamentals/api/).


    For information regarding rate limits, refer to our [API Rate
    Limits](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/platform/limits/#api-rate-limits).


    Totally new to Cloudflare? [Start
    here](https://developers.cloudflare.com/fundamentals/get-started/).
  license:
    name: BSD-3-Clause
    url: https://opensource.org/licenses/BSD-3-Clause
  title: Cloudflare API
  version: 4.0.0
servers:
  - description: Client API
    url: https://api.cloudflare.com/client/v4
paths:
  /zones/{zone_id}/settings/zaraz/config:
    get:
      description: >-
        Gets latest Zaraz configuration for a zone. It can be preview or
        published configuration, whichever was the last updated. Secret
        variables values will not be included.
      operationId: get-zones-zone_identifier-zaraz-config
      parameters:
        - in: path
          name: zone_id
          required: true
          schema:
            $ref: '#/components/schemas/zaraz_identifier'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_zaraz-config-response'
          description: Get Zaraz configuration response
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_api-response-common-failure'
          description: Get Zaraz configuration response failure
      security:
        - api_token: []
        - api_email: []
          api_key: []
      summary: Get Zaraz configuration
      tags:
        - Zaraz
      x-api-token-group:
        - Zaraz Edit
        - Zaraz Read
        - Zaraz Admin
    put:
      description: Updates Zaraz configuration for a zone.
      operationId: put-zones-zone_identifier-zaraz-config
      parameters:
        - in: path
          name: zone_id
          required: true
          schema:
            $ref: '#/components/schemas/zaraz_identifier'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/zaraz_zaraz-config-body'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_zaraz-config-response'
          description: Update Zaraz configuration response
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_api-response-common-failure'
          description: Update Zaraz configuration response failure
      security:
        - api_token: []
        - api_email: []
          api_key: []
      summary: Update Zaraz configuration
      tags:
        - Zaraz
      x-api-token-group:
        - Zaraz Edit
        - Zaraz Admin
  /zones/{zone_id}/settings/zaraz/default:
    get:
      description: Gets default Zaraz configuration for a zone.
      operationId: get-zones-zone_identifier-zaraz-default
      parameters:
        - in: path
          name: zone_id
          required: true
          schema:
            $ref: '#/components/schemas/zaraz_identifier'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_zaraz-config-response'
          description: Get Zaraz default configuration response
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_api-response-common-failure'
          description: Get Zaraz default configuration response failure
      security:
        - api_token: []
        - api_email: []
          api_key: []
      summary: Get default Zaraz configuration
      tags:
        - Zaraz
      x-api-token-group:
        - Zaraz Edit
        - Zaraz Read
        - Zaraz Admin
  /zones/{zone_id}/settings/zaraz/export:
    get:
      description: >-
        Exports full current published Zaraz configuration for a zone, secret
        variables included.
      operationId: get-zones-zone_identifier-zaraz-export
      parameters:
        - in: path
          name: zone_id
          required: true
          schema:
            $ref: '#/components/schemas/zaraz_identifier'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_zaraz-config-return'
          description: Get Zaraz configuration response
          headers:
            Content-Disposition:
              example: attachment; filename=zaraz-2023-11-10-23-00.json
              schema:
                type: string
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_api-response-common-failure'
          description: Get Zaraz configuration response failure
      security:
        - api_token: []
        - api_email: []
          api_key: []
      summary: Export Zaraz configuration
      tags:
        - Zaraz
      x-api-token-group:
        - Zaraz Edit
        - Zaraz Read
        - Zaraz Admin
  /zones/{zone_id}/settings/zaraz/history:
    get:
      description: Lists a history of published Zaraz configuration records for a zone.
      operationId: get-zones-zone_identifier-zaraz-history
      parameters:
        - in: path
          name: zone_id
          required: true
          schema:
            $ref: '#/components/schemas/zaraz_identifier'
        - description: >-
            Ordinal number to start listing the results with. Default value is
            0.
          example: 0
          in: query
          name: offset
          schema:
            minimum: 0
            type: integer
        - description: Maximum amount of results to list. Default value is 10.
          example: 10
          in: query
          name: limit
          schema:
            minimum: 1
            type: integer
        - description: The field to sort by. Default is updated_at.
          example: updated_at
          in: query
          name: sortField
          schema:
            enum:
              - id
              - user_id
              - description
              - created_at
              - updated_at
            type: string
        - description: Sorting order. Default is DESC.
          example: DESC
          in: query
          name: sortOrder
          schema:
            enum:
              - DESC
              - ASC
            type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_zaraz-history-response'
          description: List Zaraz historical configuration records response
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_api-response-common-failure'
          description: List Zaraz historical configuration records failure
      security:
        - api_token: []
        - api_email: []
          api_key: []
      summary: List Zaraz historical configuration records
      tags:
        - Zaraz
      x-api-token-group:
        - Zaraz Edit
        - Zaraz Read
        - Zaraz Admin
    put:
      description: Restores a historical published Zaraz configuration by ID for a zone.
      operationId: put-zones-zone_identifier-zaraz-history
      parameters:
        - in: path
          name: zone_id
          required: true
          schema:
            $ref: '#/components/schemas/zaraz_identifier'
      requestBody:
        content:
          application/json:
            schema:
              description: ID of the Zaraz configuration to restore.
              example: 12345
              minimum: 1
              type: integer
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_zaraz-config-response'
          description: Restore Zaraz historical configuration by ID response
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_api-response-common-failure'
          description: Restore Zaraz historical configuration by ID failure
      security:
        - api_token: []
        - api_email: []
          api_key: []
      summary: Restore Zaraz historical configuration by ID
      tags:
        - Zaraz
      x-api-token-group:
        - Zaraz Edit
        - Zaraz Admin
  /zones/{zone_id}/settings/zaraz/history/configs:
    get:
      description: Gets a history of published Zaraz configurations by ID(s) for a zone.
      operationId: get-zones-zone_identifier-zaraz-config-history
      parameters:
        - in: path
          name: zone_id
          required: true
          schema:
            $ref: '#/components/schemas/zaraz_identifier'
        - description: Comma separated list of Zaraz configuration IDs
          example:
            - 12345
            - 23456
          explode: false
          in: query
          name: ids
          required: true
          schema:
            items:
              type: integer
            type: array
          style: form
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_zaraz-config-history-response'
          description: Get Zaraz historical configurations by ID(s) response
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_api-response-common-failure'
          description: Get Zaraz historical configurations by ID(s) failure
      security:
        - api_token: []
        - api_email: []
          api_key: []
      summary: Get Zaraz historical configurations by ID(s)
      tags:
        - Zaraz
      x-api-token-group:
        - Zaraz Edit
        - Zaraz Read
        - Zaraz Admin
  /zones/{zone_id}/settings/zaraz/publish:
    post:
      description: Publish current Zaraz preview configuration for a zone.
      operationId: post-zones-zone_identifier-zaraz-publish
      parameters:
        - in: path
          name: zone_id
          required: true
          schema:
            $ref: '#/components/schemas/zaraz_identifier'
      requestBody:
        content:
          application/json:
            schema:
              description: Zaraz configuration description.
              example: Config with enabled ecommerce tracking
              type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/zaraz_api-response-common'
                  - properties:
                      result:
                        example: Config has been published successfully
                        type: string
          description: Update Zaraz workflow response
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_api-response-common-failure'
          description: Update Zaraz workflow response failure
      security:
        - api_token: []
        - api_email: []
          api_key: []
      summary: Publish Zaraz preview configuration
      tags:
        - Zaraz
      x-api-token-group:
        - Zaraz Admin
      x-cfPermissionsRequired:
        enum:
          - '#zaraz:publish'
  /zones/{zone_id}/settings/zaraz/workflow:
    get:
      description: Gets Zaraz workflow for a zone.
      operationId: get-zones-zone_identifier-zaraz-workflow
      parameters:
        - in: path
          name: zone_id
          required: true
          schema:
            $ref: '#/components/schemas/zaraz_identifier'
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_zaraz-workflow-response'
          description: Get Zaraz workflow response
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_api-response-common-failure'
          description: Get Zaraz workflow response failure
      security:
        - api_token: []
        - api_email: []
          api_key: []
      summary: Get Zaraz workflow
      tags:
        - Zaraz
      x-api-token-group:
        - Zaraz Edit
        - Zaraz Read
        - Zaraz Admin
    put:
      description: Updates Zaraz workflow for a zone.
      operationId: put-zones-zone_identifier-zaraz-workflow
      parameters:
        - in: path
          name: zone_id
          required: true
          schema:
            $ref: '#/components/schemas/zaraz_identifier'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/zaraz_zaraz-workflow'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_zaraz-workflow-response'
          description: Update Zaraz workflow response
        4XX:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/zaraz_api-response-common-failure'
          description: Update Zaraz workflow response failure
      security:
        - api_token: []
        - api_email: []
          api_key: []
      summary: Update Zaraz workflow
      tags:
        - Zaraz
      x-api-token-group:
        - Zaraz Edit
        - Zaraz Admin
components:
  schemas:
    zaraz_api-response-common:
      properties:
        errors:
          $ref: '#/components/schemas/zaraz_messages'
        messages:
          $ref: '#/components/schemas/zaraz_messages'
        success:
          description: Whether the API call was successful
          example: true
          type: boolean
          x-auditable: true
      required:
        - success
        - errors
        - messages
        - result
      type: object
    zaraz_api-response-common-failure:
      properties:
        errors:
          allOf:
            - $ref: '#/components/schemas/zaraz_messages'
          example:
            - code: 7003
              message: No route for the URI
          minLength: 1
        messages:
          allOf:
            - $ref: '#/components/schemas/zaraz_messages'
          example: []
        result:
          enum:
            - null
          nullable: true
          type: object
        success:
          description: Whether the API call was successful.
          enum:
            - false
          example: false
          type: boolean
      required:
        - success
        - errors
        - messages
        - result
      type: object
    zaraz_identifier:
      description: Identifier.
      example: 023e105f4ecef8ad9ca31a8372d0c353
      maxLength: 32
      type: string
      x-auditable: true
    zaraz_zaraz-config-body:
      allOf:
        - $ref: '#/components/schemas/zaraz_zaraz-config-base'
        - properties:
            tools:
              additionalProperties:
                anyOf:
                  - $ref: '#/components/schemas/zaraz_managed-component'
                  - $ref: '#/components/schemas/zaraz_custom-managed-component'
              description: >-
                Tools set up under Zaraz configuration, where key is the
                alpha-numeric tool ID and value is the tool configuration
                object.
              type: object
    zaraz_zaraz-config-history-response:
      allOf:
        - $ref: '#/components/schemas/zaraz_api-response-common'
        - properties:
            result:
              additionalProperties:
                allOf:
                  - $ref: '#/components/schemas/zaraz_zaraz-config-row-base'
                  - description: >-
                      Configuration record correspoding to an ID provided in
                      query params
                    nullable: true
                    properties:
                      config:
                        $ref: '#/components/schemas/zaraz_zaraz-config-return'
                    required:
                      - config
                    type: object
              description: Object where keys are numericc onfiguration IDs
              example:
                '12345':
                  config:
                    consent:
                      cookieName: zaraz-consent
                      customIntroDisclaimerDismissed: true
                      enabled: false
                    dataLayer: true
                    debugKey: my-debug-key
                    settings:
                      autoInjectScript: true
                    tools:
                      aJvt:
                        component: facebook-pixel
                        defaultFields:
                          testKey: TEST123456
                        enabled: true
                        name: Facebook Pixel
                        neoEvents:
                          - actionType: pageview
                            blockingTriggers: []
                            data:
                              __zaraz_setting_name: Page view
                              ev: PageView
                            firingTriggers:
                              - Pageview
                        permissions:
                          - access_client_kv
                        settings:
                          accessToken: ABcdEFg
                          ecommerce: true
                          property: '12345'
                        type: component
                    triggers:
                      ktBn:
                        Pageview:
                          clientRules: []
                          description: All page loads
                          excludeRules: []
                          loadRules:
                            - match: '{{ client.__zarazTrack }}'
                              op: EQUALS
                              value: Pageview
                          name: Pageview
                          system: pageload
                    variables:
                      Autd:
                        name: ip
                        type: string
                        value: '{{ system.device.ip }}'
                    zarazVersion: 43
                  createdAt: '2023-02-23T05:05:55.155273Z'
                  id: 12345
                  updatedAt: '2023-02-23T05:05:55.155273Z'
                  userId: 278d0d0g123cd8e49d45ea64f12faa37
                '23456': null
              type: object
    zaraz_zaraz-config-response:
      allOf:
        - $ref: '#/components/schemas/zaraz_api-response-common'
        - properties:
            result:
              $ref: '#/components/schemas/zaraz_zaraz-config-return'
    zaraz_zaraz-config-return:
      allOf:
        - $ref: '#/components/schemas/zaraz_zaraz-config-base'
        - properties:
            tools:
              additionalProperties:
                anyOf:
                  - $ref: '#/components/schemas/zaraz_managed-component'
                  - $ref: '#/components/schemas/zaraz_custom-managed-component'
              description: >-
                Tools set up under Zaraz configuration, where key is the
                alpha-numeric tool ID and value is the tool configuration
                object.
              type: object
    zaraz_zaraz-history-response:
      allOf:
        - $ref: '#/components/schemas/zaraz_api-response-common'
        - properties:
            result:
              items:
                allOf:
                  - $ref: '#/components/schemas/zaraz_zaraz-config-row-base'
                  - example:
                      createdAt: '2023-02-23T05:05:55.155273Z'
                      description: Config with enabled ecommerce tracking
                      id: 12345
                      updatedAt: '2023-02-23T05:05:55.155273Z'
                      userId: 278d0d0g123cd8e49d45ea64f12faa37
                    properties:
                      description:
                        description: >-
                          Configuration description provided by the user who
                          published this configuration
                        type: string
                    required:
                      - description
                    type: object
              type: array
    zaraz_zaraz-workflow:
      description: Zaraz workflow
      enum:
        - realtime
        - preview
      type: string
      x-auditable: true
    zaraz_zaraz-workflow-response:
      allOf:
        - $ref: '#/components/schemas/zaraz_api-response-common'
        - properties:
            result:
              $ref: '#/components/schemas/zaraz_zaraz-workflow'
