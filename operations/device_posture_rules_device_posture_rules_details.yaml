openapi: 3.0.3
info:
  description: >-
    Welcome to Cloudflare's API documentation site. We are experimenting with an
    updated version of our API documentation - check out
    [developers.cloudflare.com/api-next/](https://developers.cloudflare.com/api-next/)
    to test out the new experience.


    To get started using Cloudflare's products and services via the API, refer
    to [how to interact with
    Cloudflare](https://developers.cloudflare.com/fundamentals/basic-tasks/interact-with-cloudflare/),
    which covers using tools like
    [Terraform](https://developers.cloudflare.com/terraform/#cloudflare-terraform)
    and the [official
    SDKs](https://developers.cloudflare.com/fundamentals/api/reference/sdks/) to
    maintain your Cloudflare resources.


    Using the Cloudflare API requires authentication so that Cloudflare knows
    who is making requests and what permissions you have. Create an API token to
    grant access to the API to perform actions. You can also authenticate with
    [API
    keys](https://developers.cloudflare.com/fundamentals/api/get-started/keys/),
    but these keys have [several
    limitations](https://developers.cloudflare.com/fundamentals/api/get-started/keys/#limitations)
    that make them less secure than API tokens. Whenever possible, use API
    tokens to interact with the Cloudflare API.


    To create an API token, from the Cloudflare dashboard, go to My Profile >
    API Tokens and select Create Token. For more information on how to create
    and troubleshoot API tokens, refer to

    our [API fundamentals](https://developers.cloudflare.com/fundamentals/api/).


    For information regarding rate limits, refer to our [API Rate
    Limits](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/platform/limits/#api-rate-limits).


    Totally new to Cloudflare? [Start
    here](https://developers.cloudflare.com/fundamentals/get-started/).
  license:
    name: BSD-3-Clause
    url: https://opensource.org/licenses/BSD-3-Clause
  title: Cloudflare API
  version: 4.0.0
servers:
  - description: Client API
    url: https://api.cloudflare.com/client/v4
paths:
  /accounts/{account_id}/devices/posture/{rule_id}:
    get:
      description: Fetches a single device posture rule.
      operationId: device-posture-rules-device-posture-rules-details
      parameters:
        - in: path
          name: rule_id
          required: true
          schema:
            description: API UUID.
            example: f174e90a-fafe-4643-bbbc-4a0ed4fc8415
            maxLength: 36
            type: string
            x-auditable: true
        - in: path
          name: account_id
          required: true
          schema:
            example: 699d98642c564d2e855e9661899b7252
      responses:
        '200':
          content:
            application/json:
              schema:
                allOf:
                  - allOf:
                      - properties:
                          errors:
                            example: []
                            items:
                              properties:
                                code:
                                  minimum: 1000
                                  type: integer
                                message:
                                  type: string
                              required:
                                - code
                                - message
                              type: object
                              uniqueItems: true
                            type: array
                          messages:
                            example: []
                            items:
                              properties:
                                code:
                                  minimum: 1000
                                  type: integer
                                message:
                                  type: string
                              required:
                                - code
                                - message
                              type: object
                              uniqueItems: true
                            type: array
                          result:
                            anyOf:
                              - type: object
                              - items:
                                  type: object
                                type: array
                              - type: string
                          success:
                            description: Whether the API call was successful.
                            enum:
                              - true
                            example: true
                            type: boolean
                        required:
                          - success
                          - errors
                          - messages
                          - result
                        type: object
                      - properties:
                          result:
                            anyOf:
                              - type: object
                              - type: string
                            nullable: true
                            type: object
                        type: object
                    type: object
                  - properties:
                      result:
                        properties:
                          description:
                            default: ''
                            description: The description of the device posture rule.
                            example: The rule for admin serial numbers
                            type: string
                            x-auditable: true
                          expiration:
                            description: >-
                              Sets the expiration time for a posture check
                              result. If empty, the result remains valid until
                              it is overwritten by new data from the WARP
                              client.
                            example: 1h
                            type: string
                          id:
                            description: API UUID.
                            example: f174e90a-fafe-4643-bbbc-4a0ed4fc8415
                            maxLength: 36
                            type: string
                            x-auditable: true
                          input:
                            description: The value to be checked against.
                            example:
                              operating_system: linux
                              path: /bin/cat
                              thumbprint: >-
                                0aabab210bdb998e9cf45da2c9ce352977ab531c681b74cf1e487be1bbe9fe6e
                            oneOf:
                              - properties:
                                  exists:
                                    description: Whether or not file exists.
                                    example: true
                                    type: boolean
                                    x-auditable: true
                                  operating_system:
                                    description: Operating system.
                                    enum:
                                      - windows
                                      - linux
                                      - mac
                                    example: mac
                                    type: string
                                    x-auditable: true
                                  path:
                                    description: File path.
                                    example: /bin/cat
                                    type: string
                                    x-auditable: true
                                  sha256:
                                    description: SHA-256.
                                    example: https://api.us-2.crowdstrike.com
                                    type: string
                                  thumbprint:
                                    description: Signing certificate thumbprint.
                                    example: >-
                                      0aabab210bdb998e9cf45da2c9ce352977ab531c681b74cf1e487be1bbe9fe6e
                                    type: string
                                required:
                                  - path
                                  - operating_system
                                title: File Check
                                type: object
                              - properties:
                                  id:
                                    description: List ID.
                                    example: da3de859-8f6e-47ea-a2b5-b2433858471f
                                    type: string
                                    x-auditable: true
                                  operating_system:
                                    description: Operating System.
                                    enum:
                                      - android
                                      - ios
                                      - chromeos
                                    example: android
                                    type: string
                                    x-auditable: true
                                required:
                                  - operating_system
                                  - id
                                title: Unique Client ID
                                type: object
                              - properties:
                                  domain:
                                    description: Domain.
                                    example: example.com
                                    type: string
                                    x-auditable: true
                                  operating_system:
                                    description: Operating System.
                                    enum:
                                      - windows
                                    example: windows
                                    type: string
                                    x-auditable: true
                                required:
                                  - operating_system
                                title: Domain Joined
                                type: object
                              - properties:
                                  operating_system:
                                    description: Operating System.
                                    enum:
                                      - windows
                                    example: windows
                                    type: string
                                    x-auditable: true
                                  operator:
                                    description: Operator.
                                    enum:
                                      - <
                                      - <=
                                      - '>'
                                      - '>='
                                      - '=='
                                    example: 13.3.0
                                    type: string
                                    x-auditable: true
                                  os_distro_name:
                                    description: >-
                                      Operating System Distribution Name (linux
                                      only).
                                    example: ubuntu
                                    type: string
                                    x-auditable: true
                                  os_distro_revision:
                                    description: Version of OS Distribution (linux only).
                                    example: 11.3.1
                                    type: string
                                    x-auditable: true
                                  os_version_extra:
                                    description: >-
                                      Additional version data. For Mac or iOS,
                                      the Product Version Extra. For Linux, the
                                      kernel release version. (Mac, iOS, and
                                      Linux only).
                                    example: (a) or -1007
                                    type: string
                                    x-auditable: true
                                  version:
                                    description: Version of OS.
                                    example: 13.3.0
                                    type: string
                                    x-auditable: true
                                required:
                                  - operating_system
                                  - version
                                  - operator
                                title: OS Version
                                type: object
                              - properties:
                                  enabled:
                                    description: Enabled.
                                    example: true
                                    type: boolean
                                    x-auditable: true
                                  operating_system:
                                    description: Operating System.
                                    enum:
                                      - windows
                                      - mac
                                    example: windows
                                    type: string
                                    x-auditable: true
                                required:
                                  - operating_system
                                  - enabled
                                title: Firewall
                                type: object
                              - properties:
                                  operating_system:
                                    description: Operating system.
                                    enum:
                                      - windows
                                      - linux
                                      - mac
                                    example: mac
                                    type: string
                                    x-auditable: true
                                  path:
                                    description: File path.
                                    example: /bin/cat
                                    type: string
                                    x-auditable: true
                                  sha256:
                                    description: SHA-256.
                                    example: >-
                                      b5bb9d8014a0f9b1d61e21e796d78dccdf1352f23cd32812f4850b878ae4944c
                                    type: string
                                    x-auditable: true
                                  thumbprint:
                                    description: Signing certificate thumbprint.
                                    example: >-
                                      0aabab210bdb998e9cf45da2c9ce352977ab531c681b74cf1e487be1bbe9fe6e
                                    type: string
                                    x-auditable: true
                                required:
                                  - path
                                  - operating_system
                                title: Sentinelone
                                type: object
                              - properties:
                                  operating_system:
                                    description: Operating system.
                                    enum:
                                      - windows
                                      - linux
                                      - mac
                                    example: mac
                                    type: string
                                    x-auditable: true
                                  path:
                                    description: File path.
                                    example: /bin/cat
                                    type: string
                                    x-auditable: true
                                  sha256:
                                    description: SHA-256.
                                    example: >-
                                      b5bb9d8014a0f9b1d61e21e796d78dccdf1352f23cd32812f4850b878ae4944c
                                    type: string
                                    x-auditable: true
                                  thumbprint:
                                    description: Signing certificate thumbprint.
                                    example: >-
                                      0aabab210bdb998e9cf45da2c9ce352977ab531c681b74cf1e487be1bbe9fe6e
                                    type: string
                                    x-auditable: true
                                required:
                                  - path
                                  - operating_system
                                title: Carbonblack
                                type: object
                              - properties:
                                  id:
                                    description: UUID of Access List.
                                    example: f174e90a-fafe-4643-bbbc-4a0ed4fc8415
                                    maxLength: 36
                                    type: string
                                    x-auditable: true
                                required:
                                  - id
                                title: Serial Number
                                type: object
                              - properties:
                                  checkDisks:
                                    description: >-
                                      List of volume names to be checked for
                                      encryption.
                                    example:
                                      - C
                                      - D
                                      - G
                                    items:
                                      type: string
                                    type: array
                                  requireAll:
                                    description: Whether to check all disks for encryption.
                                    example: true
                                    type: boolean
                                    x-auditable: true
                                title: Disk Encryption
                                type: object
                              - properties:
                                  operating_system:
                                    description: Operating system.
                                    enum:
                                      - windows
                                      - linux
                                      - mac
                                    example: mac
                                    type: string
                                    x-auditable: true
                                  path:
                                    description: Path for the application.
                                    example: /bin/cat
                                    type: string
                                    x-auditable: true
                                  sha256:
                                    description: SHA-256.
                                    example: >-
                                      b5bb9d8014a0f9b1d61e21e796d78dccdf1352f23cd32812f4850b878ae4944c
                                    type: string
                                    x-auditable: true
                                  thumbprint:
                                    description: Signing certificate thumbprint.
                                    example: >-
                                      0aabab210bdb998e9cf45da2c9ce352977ab531c681b74cf1e487be1bbe9fe6e
                                    type: string
                                    x-auditable: true
                                required:
                                  - path
                                  - operating_system
                                title: Application
                                type: object
                              - properties:
                                  certificate_id:
                                    description: UUID of Cloudflare managed certificate.
                                    example: b14ddcc4-bcd2-4df4-bd4f-eb27d5a50c30
                                    maxLength: 36
                                    type: string
                                  cn:
                                    description: >-
                                      Common Name that is protected by the
                                      certificate.
                                    example: example.com
                                    type: string
                                required:
                                  - certificate_id
                                  - cn
                                title: Client Certificate
                                type: object
                              - properties:
                                  certificate_id:
                                    description: UUID of Cloudflare managed certificate.
                                    example: b14ddcc4-bcd2-4df4-bd4f-eb27d5a50c30
                                    maxLength: 36
                                    type: string
                                  check_private_key:
                                    description: >-
                                      Confirm the certificate was not imported
                                      from another device. We recommend keeping
                                      this enabled unless the certificate was
                                      deployed without a private key.
                                    example: true
                                    type: boolean
                                  cn:
                                    description: >-
                                      Certificate Common Name. This may include
                                      one or more variables in the ${ }
                                      notation. Only ${serial_number} and
                                      ${hostname} are valid variables.
                                    example: ${hostname}.com.${serial_number}
                                    type: string
                                  extended_key_usage:
                                    description: >-
                                      List of values indicating purposes for
                                      which the certificate public key can be
                                      used.
                                    example:
                                      - clientAuth
                                      - emailProtection
                                    items:
                                      enum:
                                        - clientAuth
                                        - emailProtection
                                      type: string
                                      x-auditable: true
                                    type: array
                                  locations:
                                    properties:
                                      paths:
                                        description: >-
                                          List of paths to check for client
                                          certificate on linux.
                                        example:
                                          - /path1
                                          - /path2
                                        items:
                                          type: string
                                        type: array
                                      trust_stores:
                                        description: >-
                                          List of trust stores to check for client
                                          certificate.
                                        example:
                                          - system
                                          - user
                                        items:
                                          enum:
                                            - system
                                            - user
                                          type: string
                                          x-auditable: true
                                        type: array
                                    type: object
                                  operating_system:
                                    description: Operating System.
                                    enum:
                                      - windows
                                      - mac
                                      - linux
                                    example: windows
                                    type: string
                                  subject_alternative_names:
                                    description: >-
                                      List of certificate Subject Alternative
                                      Names.
                                    example:
                                      - example.com
                                      - sample.com
                                    items:
                                      type: string
                                    type: array
                                required:
                                  - certificate_id
                                  - check_private_key
                                  - operating_system
                                title: Client Certificate V2
                                type: object
                              - properties:
                                  compliance_status:
                                    description: Compliance Status.
                                    enum:
                                      - compliant
                                      - noncompliant
                                      - unknown
                                    example: compliant
                                    type: string
                                    x-auditable: true
                                  connection_id:
                                    description: Posture Integration ID.
                                    example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                    type: string
                                    x-auditable: true
                                required:
                                  - connection_id
                                  - compliance_status
                                title: Workspace One S2S Input
                                type: object
                              - properties:
                                  connection_id:
                                    description: Posture Integration ID.
                                    example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                    type: string
                                    x-auditable: true
                                  last_seen:
                                    description: >-
                                      For more details on last seen, please
                                      refer to the Crowdstrike documentation.
                                    example: 15d3h20m4s
                                    type: string
                                    x-auditable: true
                                  operator:
                                    description: Operator.
                                    enum:
                                      - <
                                      - <=
                                      - '>'
                                      - '>='
                                      - '=='
                                    example: '>'
                                    type: string
                                    x-auditable: true
                                  os:
                                    description: Os Version.
                                    example: 13.3.0
                                    type: string
                                    x-auditable: true
                                  overall:
                                    description: Overall.
                                    example: 90
                                    type: string
                                    x-auditable: true
                                  sensor_config:
                                    description: SensorConfig.
                                    example: 90
                                    type: string
                                    x-auditable: true
                                  state:
                                    description: >-
                                      For more details on state, please refer to
                                      the Crowdstrike documentation.
                                    enum:
                                      - online
                                      - offline
                                      - unknown
                                    example: online
                                    type: string
                                    x-auditable: true
                                  version:
                                    description: Version.
                                    example: 13.3.0
                                    type: string
                                    x-auditable: true
                                  versionOperator:
                                    description: Version Operator.
                                    enum:
                                      - <
                                      - <=
                                      - '>'
                                      - '>='
                                      - '=='
                                    example: '>'
                                    type: string
                                    x-auditable: true
                                required:
                                  - connection_id
                                title: Crowdstrike S2S Input
                                type: object
                              - properties:
                                  compliance_status:
                                    description: Compliance Status.
                                    enum:
                                      - compliant
                                      - noncompliant
                                      - unknown
                                      - notapplicable
                                      - ingraceperiod
                                      - error
                                    example: compliant
                                    type: string
                                    x-auditable: true
                                  connection_id:
                                    description: Posture Integration ID.
                                    example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                    type: string
                                    x-auditable: true
                                required:
                                  - connection_id
                                  - compliance_status
                                title: Intune S2S Input
                                type: object
                              - properties:
                                  connection_id:
                                    description: Posture Integration ID.
                                    example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                    type: string
                                    x-auditable: true
                                  countOperator:
                                    description: Count Operator.
                                    enum:
                                      - <
                                      - <=
                                      - '>'
                                      - '>='
                                      - '=='
                                    example: '>'
                                    type: string
                                    x-auditable: true
                                  issue_count:
                                    description: The Number of Issues.
                                    example: 1
                                    type: string
                                    x-auditable: true
                                required:
                                  - connection_id
                                  - countOperator
                                  - issue_count
                                title: Kolide S2S Input
                                type: object
                              - properties:
                                  connection_id:
                                    description: Posture Integration ID.
                                    example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                    type: string
                                    x-auditable: true
                                  eid_last_seen:
                                    description: >-
                                      For more details on eid last seen, refer
                                      to the Tanium documentation.
                                    example: '2023-07-20T23:16:32Z'
                                    type: string
                                    x-auditable: true
                                  operator:
                                    description: >-
                                      Operator to evaluate risk_level or
                                      eid_last_seen.
                                    enum:
                                      - <
                                      - <=
                                      - '>'
                                      - '>='
                                      - '=='
                                    example: '>'
                                    type: string
                                    x-auditable: true
                                  risk_level:
                                    description: >-
                                      For more details on risk level, refer to
                                      the Tanium documentation.
                                    enum:
                                      - low
                                      - medium
                                      - high
                                      - critical
                                    example: low
                                    type: string
                                    x-auditable: true
                                  scoreOperator:
                                    description: Score Operator.
                                    enum:
                                      - <
                                      - <=
                                      - '>'
                                      - '>='
                                      - '=='
                                    example: '>'
                                    type: string
                                    x-auditable: true
                                  total_score:
                                    description: >-
                                      For more details on total score, refer to
                                      the Tanium documentation.
                                    example: 1
                                    type: number
                                    x-auditable: true
                                required:
                                  - connection_id
                                title: Tanium S2S Input
                                type: object
                              - properties:
                                  active_threats:
                                    description: The Number of active threats.
                                    example: 1
                                    type: number
                                  connection_id:
                                    description: Posture Integration ID.
                                    example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                    type: string
                                  infected:
                                    description: Whether device is infected.
                                    example: true
                                    type: boolean
                                  is_active:
                                    description: Whether device is active.
                                    example: true
                                    type: boolean
                                  network_status:
                                    description: Network status of device.
                                    enum:
                                      - connected
                                      - disconnected
                                      - disconnecting
                                      - connecting
                                    example: connected
                                    type: string
                                  operational_state:
                                    description: Agent operational state.
                                    enum:
                                      - na
                                      - partially_disabled
                                      - auto_fully_disabled
                                      - fully_disabled
                                      - auto_partially_disabled
                                      - disabled_error
                                      - db_corruption
                                    type: string
                                  operator:
                                    description: Operator.
                                    enum:
                                      - <
                                      - <=
                                      - '>'
                                      - '>='
                                      - '=='
                                    example: '>'
                                    type: string
                                required:
                                  - connection_id
                                title: SentinelOne S2S Input
                                type: object
                              - properties:
                                  connection_id:
                                    description: Posture Integration ID.
                                    example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                    type: string
                                  operator:
                                    description: Operator.
                                    enum:
                                      - <
                                      - <=
                                      - '>'
                                      - '>='
                                      - '=='
                                    example: '>'
                                    type: string
                                  score:
                                    description: >-
                                      A value between 0-100 assigned to devices
                                      set by the 3rd party posture provider.
                                    example: 100
                                    type: number
                                required:
                                  - connection_id
                                  - score
                                  - operator
                                title: Custom Device Posture Integration Input
                                type: object
                            type: object
                          match:
                            description: >-
                              The conditions that the client must match to run
                              the rule.
                            items:
                              properties:
                                platform:
                                  enum:
                                    - windows
                                    - mac
                                    - linux
                                    - android
                                    - ios
                                    - chromeos
                                  example: windows
                                  type: string
                                  x-auditable: true
                              type: object
                            type: array
                          name:
                            description: The name of the device posture rule.
                            example: Admin Serial Numbers
                            type: string
                            x-auditable: true
                          schedule:
                            description: >-
                              Polling frequency for the WARP client posture
                              check. Default: `5m` (poll every five minutes).
                              Minimum: `1m`.
                            example: 1h
                            type: string
                            x-auditable: true
                          type:
                            description: The type of device posture rule.
                            enum:
                              - file
                              - application
                              - tanium
                              - gateway
                              - warp
                              - disk_encryption
                              - serial_number
                              - sentinelone
                              - carbonblack
                              - firewall
                              - os_version
                              - domain_joined
                              - client_certificate
                              - client_certificate_v2
                              - unique_client_id
                              - kolide
                              - tanium_s2s
                              - crowdstrike_s2s
                              - intune
                              - workspace_one
                              - sentinelone_s2s
                              - custom_s2s
                            example: file
                            type: string
                            x-auditable: true
                        type: object
                    type: object
          description: Get device posture rule details response.
        4XX:
          content:
            application/json:
              schema:
                allOf:
                  - allOf:
                      - allOf:
                          - properties:
                              errors:
                                example: []
                                items:
                                  properties:
                                    code:
                                      minimum: 1000
                                      type: integer
                                    message:
                                      type: string
                                  required:
                                    - code
                                    - message
                                  type: object
                                  uniqueItems: true
                                type: array
                              messages:
                                example: []
                                items:
                                  properties:
                                    code:
                                      minimum: 1000
                                      type: integer
                                    message:
                                      type: string
                                  required:
                                    - code
                                    - message
                                  type: object
                                  uniqueItems: true
                                type: array
                              result:
                                anyOf:
                                  - type: object
                                  - items:
                                      type: object
                                    type: array
                                  - type: string
                              success:
                                description: Whether the API call was successful.
                                enum:
                                  - true
                                example: true
                                type: boolean
                            required:
                              - success
                              - errors
                              - messages
                              - result
                            type: object
                          - properties:
                              result:
                                anyOf:
                                  - type: object
                                  - type: string
                                nullable: true
                                type: object
                            type: object
                        type: object
                      - properties:
                          result:
                            properties:
                              description:
                                default: ''
                                description: The description of the device posture rule.
                                example: The rule for admin serial numbers
                                type: string
                                x-auditable: true
                              expiration:
                                description: >-
                                  Sets the expiration time for a posture check
                                  result. If empty, the result remains valid
                                  until it is overwritten by new data from the
                                  WARP client.
                                example: 1h
                                type: string
                              id:
                                description: API UUID.
                                example: f174e90a-fafe-4643-bbbc-4a0ed4fc8415
                                maxLength: 36
                                type: string
                                x-auditable: true
                              input:
                                description: The value to be checked against.
                                example:
                                  operating_system: linux
                                  path: /bin/cat
                                  thumbprint: >-
                                    0aabab210bdb998e9cf45da2c9ce352977ab531c681b74cf1e487be1bbe9fe6e
                                oneOf:
                                  - properties:
                                      exists:
                                        description: Whether or not file exists.
                                        example: true
                                        type: boolean
                                        x-auditable: true
                                      operating_system:
                                        description: Operating system.
                                        enum:
                                          - windows
                                          - linux
                                          - mac
                                        example: mac
                                        type: string
                                        x-auditable: true
                                      path:
                                        description: File path.
                                        example: /bin/cat
                                        type: string
                                        x-auditable: true
                                      sha256:
                                        description: SHA-256.
                                        example: https://api.us-2.crowdstrike.com
                                        type: string
                                      thumbprint:
                                        description: Signing certificate thumbprint.
                                        example: >-
                                          0aabab210bdb998e9cf45da2c9ce352977ab531c681b74cf1e487be1bbe9fe6e
                                        type: string
                                    required:
                                      - path
                                      - operating_system
                                    title: File Check
                                    type: object
                                  - properties:
                                      id:
                                        description: List ID.
                                        example: da3de859-8f6e-47ea-a2b5-b2433858471f
                                        type: string
                                        x-auditable: true
                                      operating_system:
                                        description: Operating System.
                                        enum:
                                          - android
                                          - ios
                                          - chromeos
                                        example: android
                                        type: string
                                        x-auditable: true
                                    required:
                                      - operating_system
                                      - id
                                    title: Unique Client ID
                                    type: object
                                  - properties:
                                      domain:
                                        description: Domain.
                                        example: example.com
                                        type: string
                                        x-auditable: true
                                      operating_system:
                                        description: Operating System.
                                        enum:
                                          - windows
                                        example: windows
                                        type: string
                                        x-auditable: true
                                    required:
                                      - operating_system
                                    title: Domain Joined
                                    type: object
                                  - properties:
                                      operating_system:
                                        description: Operating System.
                                        enum:
                                          - windows
                                        example: windows
                                        type: string
                                        x-auditable: true
                                      operator:
                                        description: Operator.
                                        enum:
                                          - <
                                          - <=
                                          - '>'
                                          - '>='
                                          - '=='
                                        example: 13.3.0
                                        type: string
                                        x-auditable: true
                                      os_distro_name:
                                        description: >-
                                          Operating System Distribution Name
                                          (linux only).
                                        example: ubuntu
                                        type: string
                                        x-auditable: true
                                      os_distro_revision:
                                        description: Version of OS Distribution (linux only).
                                        example: 11.3.1
                                        type: string
                                        x-auditable: true
                                      os_version_extra:
                                        description: >-
                                          Additional version data. For Mac or iOS,
                                          the Product Version Extra. For Linux,
                                          the kernel release version. (Mac, iOS,
                                          and Linux only).
                                        example: (a) or -1007
                                        type: string
                                        x-auditable: true
                                      version:
                                        description: Version of OS.
                                        example: 13.3.0
                                        type: string
                                        x-auditable: true
                                    required:
                                      - operating_system
                                      - version
                                      - operator
                                    title: OS Version
                                    type: object
                                  - properties:
                                      enabled:
                                        description: Enabled.
                                        example: true
                                        type: boolean
                                        x-auditable: true
                                      operating_system:
                                        description: Operating System.
                                        enum:
                                          - windows
                                          - mac
                                        example: windows
                                        type: string
                                        x-auditable: true
                                    required:
                                      - operating_system
                                      - enabled
                                    title: Firewall
                                    type: object
                                  - properties:
                                      operating_system:
                                        description: Operating system.
                                        enum:
                                          - windows
                                          - linux
                                          - mac
                                        example: mac
                                        type: string
                                        x-auditable: true
                                      path:
                                        description: File path.
                                        example: /bin/cat
                                        type: string
                                        x-auditable: true
                                      sha256:
                                        description: SHA-256.
                                        example: >-
                                          b5bb9d8014a0f9b1d61e21e796d78dccdf1352f23cd32812f4850b878ae4944c
                                        type: string
                                        x-auditable: true
                                      thumbprint:
                                        description: Signing certificate thumbprint.
                                        example: >-
                                          0aabab210bdb998e9cf45da2c9ce352977ab531c681b74cf1e487be1bbe9fe6e
                                        type: string
                                        x-auditable: true
                                    required:
                                      - path
                                      - operating_system
                                    title: Sentinelone
                                    type: object
                                  - properties:
                                      operating_system:
                                        description: Operating system.
                                        enum:
                                          - windows
                                          - linux
                                          - mac
                                        example: mac
                                        type: string
                                        x-auditable: true
                                      path:
                                        description: File path.
                                        example: /bin/cat
                                        type: string
                                        x-auditable: true
                                      sha256:
                                        description: SHA-256.
                                        example: >-
                                          b5bb9d8014a0f9b1d61e21e796d78dccdf1352f23cd32812f4850b878ae4944c
                                        type: string
                                        x-auditable: true
                                      thumbprint:
                                        description: Signing certificate thumbprint.
                                        example: >-
                                          0aabab210bdb998e9cf45da2c9ce352977ab531c681b74cf1e487be1bbe9fe6e
                                        type: string
                                        x-auditable: true
                                    required:
                                      - path
                                      - operating_system
                                    title: Carbonblack
                                    type: object
                                  - properties:
                                      id:
                                        description: UUID of Access List.
                                        example: f174e90a-fafe-4643-bbbc-4a0ed4fc8415
                                        maxLength: 36
                                        type: string
                                        x-auditable: true
                                    required:
                                      - id
                                    title: Serial Number
                                    type: object
                                  - properties:
                                      checkDisks:
                                        description: >-
                                          List of volume names to be checked for
                                          encryption.
                                        example:
                                          - C
                                          - D
                                          - G
                                        items:
                                          type: string
                                        type: array
                                      requireAll:
                                        description: >-
                                          Whether to check all disks for
                                          encryption.
                                        example: true
                                        type: boolean
                                        x-auditable: true
                                    title: Disk Encryption
                                    type: object
                                  - properties:
                                      operating_system:
                                        description: Operating system.
                                        enum:
                                          - windows
                                          - linux
                                          - mac
                                        example: mac
                                        type: string
                                        x-auditable: true
                                      path:
                                        description: Path for the application.
                                        example: /bin/cat
                                        type: string
                                        x-auditable: true
                                      sha256:
                                        description: SHA-256.
                                        example: >-
                                          b5bb9d8014a0f9b1d61e21e796d78dccdf1352f23cd32812f4850b878ae4944c
                                        type: string
                                        x-auditable: true
                                      thumbprint:
                                        description: Signing certificate thumbprint.
                                        example: >-
                                          0aabab210bdb998e9cf45da2c9ce352977ab531c681b74cf1e487be1bbe9fe6e
                                        type: string
                                        x-auditable: true
                                    required:
                                      - path
                                      - operating_system
                                    title: Application
                                    type: object
                                  - properties:
                                      certificate_id:
                                        description: UUID of Cloudflare managed certificate.
                                        example: b14ddcc4-bcd2-4df4-bd4f-eb27d5a50c30
                                        maxLength: 36
                                        type: string
                                      cn:
                                        description: >-
                                          Common Name that is protected by the
                                          certificate.
                                        example: example.com
                                        type: string
                                    required:
                                      - certificate_id
                                      - cn
                                    title: Client Certificate
                                    type: object
                                  - properties:
                                      certificate_id:
                                        description: UUID of Cloudflare managed certificate.
                                        example: b14ddcc4-bcd2-4df4-bd4f-eb27d5a50c30
                                        maxLength: 36
                                        type: string
                                      check_private_key:
                                        description: >-
                                          Confirm the certificate was not imported
                                          from another device. We recommend
                                          keeping this enabled unless the
                                          certificate was deployed without a
                                          private key.
                                        example: true
                                        type: boolean
                                      cn:
                                        description: >-
                                          Certificate Common Name. This may
                                          include one or more variables in the ${
                                          } notation. Only ${serial_number} and
                                          ${hostname} are valid variables.
                                        example: ${hostname}.com.${serial_number}
                                        type: string
                                      extended_key_usage:
                                        description: >-
                                          List of values indicating purposes for
                                          which the certificate public key can be
                                          used.
                                        example:
                                          - clientAuth
                                          - emailProtection
                                        items:
                                          enum:
                                            - clientAuth
                                            - emailProtection
                                          type: string
                                          x-auditable: true
                                        type: array
                                      locations:
                                        properties:
                                          paths:
                                            description: >-
                                              List of paths to check for client
                                              certificate on linux.
                                            example:
                                              - /path1
                                              - /path2
                                            items:
                                              type: string
                                            type: array
                                          trust_stores:
                                            description: >-
                                              List of trust stores to check for client
                                              certificate.
                                            example:
                                              - system
                                              - user
                                            items:
                                              enum:
                                                - system
                                                - user
                                              type: string
                                              x-auditable: true
                                            type: array
                                        type: object
                                      operating_system:
                                        description: Operating System.
                                        enum:
                                          - windows
                                          - mac
                                          - linux
                                        example: windows
                                        type: string
                                      subject_alternative_names:
                                        description: >-
                                          List of certificate Subject Alternative
                                          Names.
                                        example:
                                          - example.com
                                          - sample.com
                                        items:
                                          type: string
                                        type: array
                                    required:
                                      - certificate_id
                                      - check_private_key
                                      - operating_system
                                    title: Client Certificate V2
                                    type: object
                                  - properties:
                                      compliance_status:
                                        description: Compliance Status.
                                        enum:
                                          - compliant
                                          - noncompliant
                                          - unknown
                                        example: compliant
                                        type: string
                                        x-auditable: true
                                      connection_id:
                                        description: Posture Integration ID.
                                        example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                        type: string
                                        x-auditable: true
                                    required:
                                      - connection_id
                                      - compliance_status
                                    title: Workspace One S2S Input
                                    type: object
                                  - properties:
                                      connection_id:
                                        description: Posture Integration ID.
                                        example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                        type: string
                                        x-auditable: true
                                      last_seen:
                                        description: >-
                                          For more details on last seen, please
                                          refer to the Crowdstrike documentation.
                                        example: 15d3h20m4s
                                        type: string
                                        x-auditable: true
                                      operator:
                                        description: Operator.
                                        enum:
                                          - <
                                          - <=
                                          - '>'
                                          - '>='
                                          - '=='
                                        example: '>'
                                        type: string
                                        x-auditable: true
                                      os:
                                        description: Os Version.
                                        example: 13.3.0
                                        type: string
                                        x-auditable: true
                                      overall:
                                        description: Overall.
                                        example: 90
                                        type: string
                                        x-auditable: true
                                      sensor_config:
                                        description: SensorConfig.
                                        example: 90
                                        type: string
                                        x-auditable: true
                                      state:
                                        description: >-
                                          For more details on state, please refer
                                          to the Crowdstrike documentation.
                                        enum:
                                          - online
                                          - offline
                                          - unknown
                                        example: online
                                        type: string
                                        x-auditable: true
                                      version:
                                        description: Version.
                                        example: 13.3.0
                                        type: string
                                        x-auditable: true
                                      versionOperator:
                                        description: Version Operator.
                                        enum:
                                          - <
                                          - <=
                                          - '>'
                                          - '>='
                                          - '=='
                                        example: '>'
                                        type: string
                                        x-auditable: true
                                    required:
                                      - connection_id
                                    title: Crowdstrike S2S Input
                                    type: object
                                  - properties:
                                      compliance_status:
                                        description: Compliance Status.
                                        enum:
                                          - compliant
                                          - noncompliant
                                          - unknown
                                          - notapplicable
                                          - ingraceperiod
                                          - error
                                        example: compliant
                                        type: string
                                        x-auditable: true
                                      connection_id:
                                        description: Posture Integration ID.
                                        example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                        type: string
                                        x-auditable: true
                                    required:
                                      - connection_id
                                      - compliance_status
                                    title: Intune S2S Input
                                    type: object
                                  - properties:
                                      connection_id:
                                        description: Posture Integration ID.
                                        example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                        type: string
                                        x-auditable: true
                                      countOperator:
                                        description: Count Operator.
                                        enum:
                                          - <
                                          - <=
                                          - '>'
                                          - '>='
                                          - '=='
                                        example: '>'
                                        type: string
                                        x-auditable: true
                                      issue_count:
                                        description: The Number of Issues.
                                        example: 1
                                        type: string
                                        x-auditable: true
                                    required:
                                      - connection_id
                                      - countOperator
                                      - issue_count
                                    title: Kolide S2S Input
                                    type: object
                                  - properties:
                                      connection_id:
                                        description: Posture Integration ID.
                                        example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                        type: string
                                        x-auditable: true
                                      eid_last_seen:
                                        description: >-
                                          For more details on eid last seen, refer
                                          to the Tanium documentation.
                                        example: '2023-07-20T23:16:32Z'
                                        type: string
                                        x-auditable: true
                                      operator:
                                        description: >-
                                          Operator to evaluate risk_level or
                                          eid_last_seen.
                                        enum:
                                          - <
                                          - <=
                                          - '>'
                                          - '>='
                                          - '=='
                                        example: '>'
                                        type: string
                                        x-auditable: true
                                      risk_level:
                                        description: >-
                                          For more details on risk level, refer to
                                          the Tanium documentation.
                                        enum:
                                          - low
                                          - medium
                                          - high
                                          - critical
                                        example: low
                                        type: string
                                        x-auditable: true
                                      scoreOperator:
                                        description: Score Operator.
                                        enum:
                                          - <
                                          - <=
                                          - '>'
                                          - '>='
                                          - '=='
                                        example: '>'
                                        type: string
                                        x-auditable: true
                                      total_score:
                                        description: >-
                                          For more details on total score, refer
                                          to the Tanium documentation.
                                        example: 1
                                        type: number
                                        x-auditable: true
                                    required:
                                      - connection_id
                                    title: Tanium S2S Input
                                    type: object
                                  - properties:
                                      active_threats:
                                        description: The Number of active threats.
                                        example: 1
                                        type: number
                                      connection_id:
                                        description: Posture Integration ID.
                                        example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                        type: string
                                      infected:
                                        description: Whether device is infected.
                                        example: true
                                        type: boolean
                                      is_active:
                                        description: Whether device is active.
                                        example: true
                                        type: boolean
                                      network_status:
                                        description: Network status of device.
                                        enum:
                                          - connected
                                          - disconnected
                                          - disconnecting
                                          - connecting
                                        example: connected
                                        type: string
                                      operational_state:
                                        description: Agent operational state.
                                        enum:
                                          - na
                                          - partially_disabled
                                          - auto_fully_disabled
                                          - fully_disabled
                                          - auto_partially_disabled
                                          - disabled_error
                                          - db_corruption
                                        type: string
                                      operator:
                                        description: Operator.
                                        enum:
                                          - <
                                          - <=
                                          - '>'
                                          - '>='
                                          - '=='
                                        example: '>'
                                        type: string
                                    required:
                                      - connection_id
                                    title: SentinelOne S2S Input
                                    type: object
                                  - properties:
                                      connection_id:
                                        description: Posture Integration ID.
                                        example: bc7cbfbb-600a-42e4-8a23-45b5e85f804f
                                        type: string
                                      operator:
                                        description: Operator.
                                        enum:
                                          - <
                                          - <=
                                          - '>'
                                          - '>='
                                          - '=='
                                        example: '>'
                                        type: string
                                      score:
                                        description: >-
                                          A value between 0-100 assigned to
                                          devices set by the 3rd party posture
                                          provider.
                                        example: 100
                                        type: number
                                    required:
                                      - connection_id
                                      - score
                                      - operator
                                    title: Custom Device Posture Integration Input
                                    type: object
                                type: object
                              match:
                                description: >-
                                  The conditions that the client must match to
                                  run the rule.
                                items:
                                  properties:
                                    platform:
                                      enum:
                                        - windows
                                        - mac
                                        - linux
                                        - android
                                        - ios
                                        - chromeos
                                      example: windows
                                      type: string
                                      x-auditable: true
                                  type: object
                                type: array
                              name:
                                description: The name of the device posture rule.
                                example: Admin Serial Numbers
                                type: string
                                x-auditable: true
                              schedule:
                                description: >-
                                  Polling frequency for the WARP client posture
                                  check. Default: `5m` (poll every five
                                  minutes). Minimum: `1m`.
                                example: 1h
                                type: string
                                x-auditable: true
                              type:
                                description: The type of device posture rule.
                                enum:
                                  - file
                                  - application
                                  - tanium
                                  - gateway
                                  - warp
                                  - disk_encryption
                                  - serial_number
                                  - sentinelone
                                  - carbonblack
                                  - firewall
                                  - os_version
                                  - domain_joined
                                  - client_certificate
                                  - client_certificate_v2
                                  - unique_client_id
                                  - kolide
                                  - tanium_s2s
                                  - crowdstrike_s2s
                                  - intune
                                  - workspace_one
                                  - sentinelone_s2s
                                  - custom_s2s
                                example: file
                                type: string
                                x-auditable: true
                            type: object
                        type: object
                  - properties:
                      errors:
                        allOf:
                          - example: []
                            items:
                              properties:
                                code:
                                  minimum: 1000
                                  type: integer
                                message:
                                  type: string
                              required:
                                - code
                                - message
                              type: object
                              uniqueItems: true
                            type: array
                        example:
                          - code: 7003
                            message: No route for the URI
                        minLength: 1
                      messages:
                        allOf:
                          - example: []
                            items:
                              properties:
                                code:
                                  minimum: 1000
                                  type: integer
                                message:
                                  type: string
                              required:
                                - code
                                - message
                              type: object
                              uniqueItems: true
                            type: array
                        example: []
                      result:
                        enum:
                          - null
                        nullable: true
                        type: object
                      success:
                        description: Whether the API call was successful.
                        enum:
                          - false
                        example: false
                        type: boolean
                    required:
                      - success
                      - errors
                      - messages
                      - result
                    type: object
          description: Get device posture rule details response failure.
      security:
        - api_email: []
          api_key: []
          api_token: []
      summary: Get device posture rule details
      tags:
        - Device posture rules
      x-api-token-group:
        - Zero Trust Read
        - Zero Trust Write
